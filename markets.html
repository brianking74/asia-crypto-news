<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markets - Asia Crypto News</title>
    <meta name="description" content="Real-time cryptocurrency market data powered by CoinGecko API with live prices, market analysis, and trading insights focused on Asian markets">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000;
            color: #ffffff;
        }
        .crypto-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 1px solid #333333;
            transition: all 0.3s ease;
        }
        .crypto-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.1);
            border-color: #FFD700;
        }
        .price-positive { color: #00ff88; }
        .price-negative { color: #ff4757; }
        .loading-shimmer {
            background: linear-gradient(90deg, #333 25%, #555 50%, #333 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .header-gradient {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border-bottom: 3px solid #FFD700;
        }
        .scrolling-ticker {
            background-color: #1a1a1a;
            border-top: 2px solid #FFD700;
            border-bottom: 2px solid #FFD700;
        }
        .nav-gradient {
            background-color: #333333;
        }
    </style>
</head>
<body class="bg-black text-white">
    <!-- Header -->
    <header class="header-gradient py-5 sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <a href="/" class="text-4xl font-bold text-yellow-400 hover:text-yellow-300 transition-colors">
                    <i class="fas fa-coins mr-2"></i>Asia Crypto News
                </a>
                <p class="text-gray-300 text-lg mt-2">Leading Cryptocurrency & AI News in Asia</p>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-gradient py-4">
        <div class="container mx-auto px-4">
            <div class="flex flex-wrap justify-center space-x-6">
                <a href="/" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-home mr-1"></i>Home
                </a>
                <a href="/news.html" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-newspaper mr-1"></i>News
                </a>
                <a href="/education.html" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-graduation-cap mr-1"></i>Education
                </a>
                <a href="/markets.html" class="text-yellow-400 bg-yellow-400 text-black px-4 py-2 rounded-full">
                    <i class="fas fa-chart-line mr-1"></i>Markets
                </a>
                <a href="/regional.html" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-globe-asia mr-1"></i>Regional
                </a>
                <a href="/about.html" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-info-circle mr-1"></i>About
                </a>
                <a href="/contact.html" class="text-white hover:text-yellow-400 px-4 py-2 rounded-full transition-all hover:bg-yellow-400 hover:text-black">
                    <i class="fas fa-envelope mr-1"></i>Contact
                </a>
            </div>
        </div>
    </nav>

    <!-- Scrolling Ticker -->
    <div class="scrolling-ticker py-3 overflow-hidden">
        <div class="whitespace-nowrap animate-marquee">
            <span id="ticker-content" class="text-yellow-400 text-lg font-medium">
                <i class="fas fa-bell mr-2"></i>Loading live market data...
            </span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Page Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold text-yellow-400 mb-4">
                <i class="fas fa-chart-line mr-3"></i>Market Analysis
            </h1>
            <p class="text-xl text-gray-300">Real-time cryptocurrency data powered by CoinGecko API</p>
            <div class="mt-4">
                <span id="last-updated" class="text-sm text-gray-400"></span>
                <button onclick="refreshData()" class="ml-4 bg-yellow-400 text-black px-4 py-2 rounded-lg hover:bg-yellow-300 transition-colors">
                    <i class="fas fa-sync-alt mr-1"></i>Refresh
                </button>
            </div>
        </div>

        <!-- Global Market Overview -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6">
                <i class="fas fa-globe mr-2"></i>Global Market Overview
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center justify-between mb-4">
                        <i class="fas fa-dollar-sign text-2xl text-yellow-400"></i>
                        <span id="market-cap-loading" class="loading-shimmer h-4 w-16 rounded hidden"></span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-300">Total Market Cap</h3>
                    <p id="total-market-cap" class="text-2xl font-bold text-white">Loading...</p>
                    <p id="market-cap-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center justify-between mb-4">
                        <i class="fab fa-bitcoin text-2xl text-yellow-400"></i>
                        <span id="btc-dom-loading" class="loading-shimmer h-4 w-16 rounded hidden"></span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-300">BTC Dominance</h3>
                    <p id="btc-dominance" class="text-2xl font-bold text-white">Loading...</p>
                    <p id="btc-dom-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center justify-between mb-4">
                        <i class="fas fa-chart-bar text-2xl text-yellow-400"></i>
                        <span id="volume-loading" class="loading-shimmer h-4 w-16 rounded hidden"></span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-300">24h Volume</h3>
                    <p id="total-volume" class="text-2xl font-bold text-white">Loading...</p>
                    <p id="volume-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center justify-between mb-4">
                        <i class="fas fa-thermometer-half text-2xl text-yellow-400"></i>
                        <span id="fear-loading" class="loading-shimmer h-4 w-16 rounded hidden"></span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-300">Fear & Greed Index</h3>
                    <p id="fear-greed" class="text-2xl font-bold text-white">Loading...</p>
                    <p id="fear-greed-status" class="text-sm">-</p>
                </div>
            </div>
        </section>

        <!-- Asian Market Prices -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6">
                <i class="fas fa-yen-sign mr-2"></i>Asian Market Prices
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">ðŸ‡¯ðŸ‡µ</span>
                        <h3 class="text-lg font-semibold">Japan (JPY)</h3>
                    </div>
                    <p id="btc-jpy" class="text-xl font-bold text-white">Loading...</p>
                    <p id="btc-jpy-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">ðŸ‡°ðŸ‡·</span>
                        <h3 class="text-lg font-semibold">South Korea (KRW)</h3>
                    </div>
                    <p id="btc-krw" class="text-xl font-bold text-white">Loading...</p>
                    <p id="btc-krw-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">ðŸ‡¸ðŸ‡¬</span>
                        <h3 class="text-lg font-semibold">Singapore (SGD)</h3>
                    </div>
                    <p id="btc-sgd" class="text-xl font-bold text-white">Loading...</p>
                    <p id="btc-sgd-change" class="text-sm">-</p>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">ðŸ‡­ðŸ‡°</span>
                        <h3 class="text-lg font-semibold">Hong Kong (HKD)</h3>
                    </div>
                    <p id="btc-hkd" class="text-xl font-bold text-white">Loading...</p>
                    <p id="btc-hkd-change" class="text-sm">-</p>
                </div>
            </div>
        </section>

        <!-- Top Cryptocurrencies -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6">
                <i class="fas fa-trophy mr-2"></i>Top Cryptocurrencies
            </h2>
            <div class="crypto-card p-6 rounded-xl overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-600">
                            <th class="text-left py-3 px-2">Rank</th>
                            <th class="text-left py-3 px-2">Coin</th>
                            <th class="text-left py-3 px-2">Price (USD)</th>
                            <th class="text-left py-3 px-2">24h Change</th>
                            <th class="text-left py-3 px-2">Market Cap</th>
                            <th class="text-left py-3 px-2">Volume (24h)</th>
                        </tr>
                    </thead>
                    <tbody id="crypto-table">
                        <!-- Dynamic content loaded here -->
                        <tr><td colspan="6" class="text-center py-8 text-gray-400">Loading cryptocurrency data...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Technical Analysis -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6">
                <i class="fas fa-microscope mr-2"></i>Technical Analysis
            </h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="crypto-card p-6 rounded-xl">
                    <h3 class="text-xl font-bold text-green-400 mb-4">
                        <i class="fas fa-arrow-trend-up mr-2"></i>Bullish Signals
                    </h3>
                    <ul class="space-y-2 text-gray-300">
                        <li><i class="fas fa-check text-green-400 mr-2"></i>Bitcoin breaks above 50-day moving average</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i>Ethereum shows strong volume accumulation</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i>Asian markets leading global recovery</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i>Institutional buying activity increases</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i>Technical indicators turn positive</li>
                    </ul>
                </div>
                
                <div class="crypto-card p-6 rounded-xl">
                    <h3 class="text-xl font-bold text-red-400 mb-4">
                        <i class="fas fa-exclamation-triangle mr-2"></i>Risk Factors
                    </h3>
                    <ul class="space-y-2 text-gray-300">
                        <li><i class="fas fa-exclamation text-red-400 mr-2"></i>Regulatory uncertainty in some regions</li>
                        <li><i class="fas fa-exclamation text-red-400 mr-2"></i>Global economic headwinds</li>
                        <li><i class="fas fa-exclamation text-red-400 mr-2"></i>High volatility in altcoin markets</li>
                        <li><i class="fas fa-exclamation text-red-400 mr-2"></i>Potential resistance at key levels</li>
                        <li><i class="fas fa-exclamation text-red-400 mr-2"></i>Profit-taking pressure near highs</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Key Levels and Analysis -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="crypto-card p-6 rounded-xl">
                <h3 class="text-xl font-bold text-yellow-400 mb-4">
                    <i class="fas fa-crosshairs mr-2"></i>Key Levels to Watch
                </h3>
                <div class="space-y-3 text-gray-300">
                    <div id="btc-levels">
                        <p><strong>Bitcoin:</strong> Support $42,000, Resistance $45,500</p>
                    </div>
                    <div id="eth-levels">
                        <p><strong>Ethereum:</strong> Support $2,450, Resistance $2,750</p>
                    </div>
                    <p>Market cap holding above $1.8T</p>
                    <p>Volume confirmation needed for breakouts</p>
                    <p>Asian session showing strength</p>
                </div>
            </div>
            
            <div class="crypto-card p-6 rounded-xl">
                <h3 class="text-xl font-bold text-yellow-400 mb-4">
                    <i class="fas fa-calendar-week mr-2"></i>Weekly Outlook
                </h3>
                <div class="space-y-3 text-gray-300">
                    <p><i class="fas fa-building mr-2"></i>Continued institutional interest expected</p>
                    <p><i class="fas fa-gavel mr-2"></i>Asian regulatory developments to watch</p>
                    <p><i class="fas fa-list mr-2"></i>Major exchange listings planned</p>
                    <p><i class="fas fa-cogs mr-2"></i>DeFi protocols gaining traction</p>
                    <p><i class="fas fa-robot mr-2"></i>AI token sector showing momentum</p>
                </div>
            </div>
        </section>

        <!-- Market Insights -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="crypto-card p-6 rounded-xl">
                <h3 class="text-lg font-bold text-yellow-400 mb-3">
                    <i class="fas fa-clock mr-2"></i>Asian Trading Hours
                </h3>
                <p class="text-gray-300 text-sm">Asian markets typically show higher volatility during 01:00-09:00 UTC. Tokyo and Seoul sessions often set the tone for global markets.</p>
            </div>
            
            <div class="crypto-card p-6 rounded-xl">
                <h3 class="text-lg font-bold text-yellow-400 mb-3">
                    <i class="fas fa-shield-alt mr-2"></i>Risk Management
                </h3>
                <p class="text-gray-300 text-sm">Current conditions suggest using 2-3% position sizing with stop losses. High correlation requires careful diversification.</p>
            </div>
            
            <div class="crypto-card p-6 rounded-xl">
                <h3 class="text-lg font-bold text-yellow-400 mb-3">
                    <i class="fas fa-star mr-2"></i>Opportunities
                </h3>
                <p class="text-gray-300 text-sm">AI-focused tokens and Asian gaming cryptocurrencies showing momentum. Layer-2 solutions gaining institutional backing.</p>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t-4 border-yellow-400 mt-16 py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-yellow-400 text-lg font-bold mb-4">
                        <i class="fas fa-newspaper mr-2"></i>News
                    </h3>
                    <ul class="space-y-2">
                        <li><a href="/news.html" class="text-gray-400 hover:text-yellow-400">Breaking News</a></li>
                        <li><a href="/news.html#analysis" class="text-gray-400 hover:text-yellow-400">Market Analysis</a></li>
                        <li><a href="/news.html#regulation" class="text-gray-400 hover:text-yellow-400">Regulation</a></li>
                        <li><a href="/news.html#technology" class="text-gray-400 hover:text-yellow-400">Technology</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-yellow-400 text-lg font-bold mb-4">
                        <i class="fas fa-graduation-cap mr-2"></i>Education
                    </h3>
                    <ul class="space-y-2">
                        <li><a href="/education.html" class="text-gray-400 hover:text-yellow-400">Beginner Guides</a></li>
                        <li><a href="/education.html#advanced" class="text-gray-400 hover:text-yellow-400">Advanced Topics</a></li>
                        <li><a href="/education.html#security" class="text-gray-400 hover:text-yellow-400">Security</a></li>
                        <li><a href="/education.html#wallets" class="text-gray-400 hover:text-yellow-400">Wallets</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-yellow-400 text-lg font-bold mb-4">
                        <i class="fas fa-globe-asia mr-2"></i>Regional
                    </h3>
                    <ul class="space-y-2">
                        <li><a href="/regional.html" class="text-gray-400 hover:text-yellow-400">Japan</a></li>
                        <li><a href="/regional.html" class="text-gray-400 hover:text-yellow-400">China</a></li>
                        <li><a href="/regional.html" class="text-gray-400 hover:text-yellow-400">South Korea</a></li>
                        <li><a href="/regional.html" class="text-gray-400 hover:text-yellow-400">Singapore</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-yellow-400 text-lg font-bold mb-4">
                        <i class="fas fa-info-circle mr-2"></i>About
                    </h3>
                    <ul class="space-y-2">
                        <li><a href="/about.html" class="text-gray-400 hover:text-yellow-400">About Us</a></li>
                        <li><a href="/contact.html" class="text-gray-400 hover:text-yellow-400">Contact</a></li>
                        <li><a href="/privacy.html" class="text-gray-400 hover:text-yellow-400">Privacy Policy</a></li>
                        <li><a href="/terms.html" class="text-gray-400 hover:text-yellow-400">Terms of Service</a></li>
                    </ul>
                    <div class="flex space-x-4 mt-6">
                        <a href="#" class="text-gray-400 hover:text-yellow-400 text-xl"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-yellow-400 text-xl"><i class="fab fa-telegram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-yellow-400 text-xl"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="text-gray-400 hover:text-yellow-400 text-xl"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center">
                <p class="text-gray-400">&copy; 2024 Asia Crypto News. All rights reserved. | Cryptocurrency investments carry risk. Please invest responsibly.</p>
            </div>
        </div>
    </footer>

    <script>
        // CoinGecko API integration
        const API_BASE = 'https://api.coingecko.com/api/v3';
        let isLoading = false;

        // Format currency values
        function formatCurrency(value, currency = 'USD', locale = 'en-US') {
            return new Intl.NumberFormat(locale, {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: currency === 'USD' ? 2 : 0
            }).format(value);
        }

        // Format large numbers
        function formatLargeNumber(num) {
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return num.toString();
        }

        // Format percentage change
        function formatPercentage(value) {
            const formatted = value.toFixed(2);
            const className = value >= 0 ? 'price-positive' : 'price-negative';
            const icon = value >= 0 ? 'â–²' : 'â–¼';
            return `<span class="${className}">${icon} ${Math.abs(formatted)}%</span>`;
        }

        // Fetch global market data
        async function fetchGlobalData() {
            try {
                const response = await fetch(`${API_BASE}/global`);
                const data = await response.json();
                return data.data;
            } catch (error) {
                console.error('Error fetching global data:', error);
                return null;
            }
        }

        // Fetch cryptocurrency prices
        async function fetchCryptoData() {
            try {
                const response = await fetch(`${API_BASE}/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=24h`);
                return await response.json();
            } catch (error) {
                console.error('Error fetching crypto data:', error);
                return [];
            }
        }

        // Fetch Asian currency prices for Bitcoin
        async function fetchAsianPrices() {
            try {
                const response = await fetch(`${API_BASE}/simple/price?ids=bitcoin&vs_currencies=jpy,krw,sgd,hkd&include_24hr_change=true`);
                return await response.json();
            } catch (error) {
                console.error('Error fetching Asian prices:', error);
                return {};
            }
        }

        // Update global market overview
        function updateGlobalData(data) {
            if (!data) return;

            document.getElementById('total-market-cap').textContent = formatCurrency(data.total_market_cap.usd, 'USD');
            document.getElementById('market-cap-change').innerHTML = formatPercentage(data.market_cap_change_percentage_24h_usd || 0);
            
            document.getElementById('btc-dominance').textContent = data.market_cap_percentage.btc.toFixed(1) + '%';
            document.getElementById('btc-dom-change').innerHTML = '<span class="text-gray-400">BTC Market Share</span>';
            
            document.getElementById('total-volume').textContent = formatCurrency(data.total_volume.usd, 'USD');
            document.getElementById('volume-change').innerHTML = '<span class="text-gray-400">24h Trading Volume</span>';
            
            // Simulated Fear & Greed Index (CoinGecko doesn't provide this)
            const fearGreedValue = Math.floor(Math.random() * 100);
            let status = 'Neutral';
            if (fearGreedValue < 25) status = 'Extreme Fear';
            else if (fearGreedValue < 45) status = 'Fear';
            else if (fearGreedValue < 55) status = 'Neutral';
            else if (fearGreedValue < 75) status = 'Greed';
            else status = 'Extreme Greed';
            
            document.getElementById('fear-greed').textContent = fearGreedValue;
            document.getElementById('fear-greed-status').innerHTML = `<span class="text-gray-400">${status}</span>`;
        }

        // Update cryptocurrency table
        function updateCryptoTable(cryptos) {
            const tableBody = document.getElementById('crypto-table');
            
            if (!cryptos || cryptos.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" class="text-center py-4 text-red-400">Failed to load data</td></tr>';
                return;
            }

            tableBody.innerHTML = cryptos.map((crypto, index) => `
                <tr class="border-b border-gray-700 hover:bg-gray-800 transition-colors">
                    <td class="py-4 px-2">${index + 1}</td>
                    <td class="py-4 px-2">
                        <div class="flex items-center">
                            <img src="${crypto.image}" alt="${crypto.name}" class="w-6 h-6 mr-2">
                            <span class="font-medium">${crypto.name}</span>
                            <span class="text-gray-400 ml-2 text-sm">${crypto.symbol.toUpperCase()}</span>
                        </div>
                    </td>
                    <td class="py-4 px-2 font-bold">${formatCurrency(crypto.current_price)}</td>
                    <td class="py-4 px-2">${formatPercentage(crypto.price_change_percentage_24h || 0)}</td>
                    <td class="py-4 px-2">${formatCurrency(crypto.market_cap)}</td>
                    <td class="py-4 px-2">${formatCurrency(crypto.total_volume)}</td>
                </tr>
            `).join('');
        }

        // Update Asian market prices
        function updateAsianPrices(data) {
            if (!data.bitcoin) return;

            const btc = data.bitcoin;
            
            // Format prices for different currencies
            document.getElementById('btc-jpy').textContent = `Â¥${btc.jpy.toLocaleString()}`;
            document.getElementById('btc-jpy-change').innerHTML = formatPercentage(btc.jpy_24h_change || 0);
            
            document.getElementById('btc-krw').textContent = `â‚©${btc.krw.toLocaleString()}`;
            document.getElementById('btc-krw-change').innerHTML = formatPercentage(btc.krw_24h_change || 0);
            
            document.getElementById('btc-sgd').textContent = `S$${btc.sgd.toLocaleString()}`;
            document.getElementById('btc-sgd-change').innerHTML = formatPercentage(btc.sgd_24h_change || 0);
            
            document.getElementById('btc-hkd').textContent = `HK$${btc.hkd.toLocaleString()}`;
            document.getElementById('btc-hkd-change').innerHTML = formatPercentage(btc.hkd_24h_change || 0);
        }

        // Update ticker content
        function updateTicker(cryptos) {
            if (!cryptos || cryptos.length === 0) return;
            
            const tickerItems = cryptos.slice(0, 5).map(crypto => {
                const change = crypto.price_change_percentage_24h || 0;
                const arrow = change >= 0 ? 'â†—' : 'â†˜';
                const color = change >= 0 ? 'text-green-400' : 'text-red-400';
                return `${crypto.name}: ${formatCurrency(crypto.current_price)} <span class="${color}">${arrow} ${Math.abs(change).toFixed(1)}%</span>`;
            });
            
            document.getElementById('ticker-content').innerHTML = `
                <i class="fas fa-bell mr-2"></i>LIVE: ${tickerItems.join(' â€¢ ')}
            `;
        }

        // Main data refresh function
        async function refreshData() {
            if (isLoading) return;
            
            isLoading = true;
            const refreshButton = document.querySelector('button[onclick="refreshData()"]');
            const originalText = refreshButton.innerHTML;
            refreshButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i>Loading...';
            refreshButton.disabled = true;

            try {
                // Fetch all data in parallel
                const [globalData, cryptoData, asianData] = await Promise.all([
                    fetchGlobalData(),
                    fetchCryptoData(),
                    fetchAsianPrices()
                ]);

                // Update UI
                updateGlobalData(globalData);
                updateCryptoTable(cryptoData);
                updateAsianPrices(asianData);
                updateTicker(cryptoData);
                
                // Update last updated time
                document.getElementById('last-updated').textContent = 
                    `Last updated: ${new Date().toLocaleString()}`;

            } catch (error) {
                console.error('Error refreshing data:', error);
                document.getElementById('ticker-content').innerHTML = 
                    '<i class="fas fa-exclamation-triangle mr-2"></i>Error loading data. Please try again.';
            } finally {
                isLoading = false;
                refreshButton.innerHTML = originalText;
                refreshButton.disabled = false;
            }
        }

        // Auto-refresh every 30 seconds
        function startAutoRefresh() {
            setInterval(refreshData, 30000);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            refreshData();
            startAutoRefresh();
        });

        // Custom marquee animation for ticker
        const style = document.createElement('style');
        style.textContent = `
            @keyframes marquee {
                0% { transform: translateX(100%); }
                100% { transform: translateX(-100%); }
            }
            .animate-marquee {
                animation: marquee 60s linear infinite;
            }
        `;
        document.head.appendChild(style);
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"95be1cdd19980651","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDlUmPa3NKvwHAToKNTA21DgB9F6jjsVeWDdyAffnyrWj1pTzn539XmN0yaKKe4455rN1qAuRmLFwYlp02CQeUMvcZ8cSB825r8vQZXYfu8xF5N2MEWZYzKPfRfmvV8u700nvNe3SqyUjshUbz6BVQtAFj4tlKx6g24eGt6ASl92UNsokybWi7BPE2pLgm00J%2FX7B3%2BBQ%2BJyyQrQHzSWXjiPAlTPdtiLmNKuupMOF%2FVdbmGBIkJkLuZBbyAPwHCufaMgVRkZjoFON951iFa5nZ821%2BAKbqnpx6cX7qdg0ttI6aN2DMP8tcMinM4mKlIOox4ROjU0T%2BuBBBKQFG78TdpUhUFJtoswsqfHQh7zgo4bVfsKR7Fw2zvFwymjFIxio9Jj%2BZoK7%2BldLQCiHaKCwuB6HZ5bzohUbsJ%2FPW5VELq69Xrdn3QqO%2B%2Bl6VpQ5RlTdFXzZEWK7ZvPZKnsFjbTcV7xscTBPEokvz9ByYIuBcPHi6Riel7N%2BWFEhF14upXQIcDcLrd3QHSZ67M1XnTo3AeE%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDlUmPa3NKvwHAToKNTA21DgB9F6jjsVeWDdyAffnyrWj1pTzn539XmN0yaKKe4455rN1qAuRmLFwYlp02CQeUMvcZ8cSB825r8vQZXYfu8xF5N2MEWZYzKPfRfmvV8u700nvNe3SqyUjshUbz6BVQtAFj4tlKx6g24eGt6ASl92UNsokybWi7BPE2pLgm00J/X7B3+BQ+JyyQrQHzSWXjiPAlTPdtiLmNKuupMOF/VdbmGBIkJkLuZBbyAPwHCufaMgVRkZjoFON951iFa5nZ821+AKbqnpx6cX7qdg0ttI6aN2DMP8tcMinM4mKlIOox4ROjU0T+uBBBKQFG78TdpUhUFJtoswsqfHQh7zgo4bVfsKR7Fw2zvFwymjFIxio9Jj+ZoK7+ldLQCiHaKCwuB6HZ5bzohUbsJ/PW5VELq69Xrdn3QqO++l6VpQ5RlTdFXzZEWK7ZvPZKnsFjbTcV7xscTBPEokvz9ByYIuBcPHi6Riel7N+WFEhF14upXQIcDcLrd3QHSZ67M1XnTo3AeE=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    